[INFO] Device: cuda
[INFO] Dataset: CROHME
[INFO] Building vocabulary...
[INFO] Vocabulary size: 114
[INFO] Special tokens - PAD: 0, BOS: 1, EOS: 2
[INFO] Loading dataset...
[INFO] Max image size: 512
[INFO] Train samples: 7951, Val samples: 883
[INFO] Building model...
[INFO] Using CosineAnnealing scheduler with 2000 warmup steps
[INFO] Starting training from epoch 1 to 100...
[INFO] Early stopping: Disabled
[INFO] Epoch 1 - Train Loss: nan (main: 3.4159) - Acc: 0.2549
[INFO] Epoch 1 - Val Loss: nan (main: 2.6238) - Acc: 0.3697
[INFO] Epoch 2 - Train Loss: nan (main: 2.8279) - Acc: 0.4072
[INFO] Epoch 2 - Val Loss: nan (main: 2.0877) - Acc: 0.4795
[INFO] Epoch 3 - Train Loss: nan (main: 2.5103) - Acc: 0.4899
[INFO] Epoch 3 - Val Loss: nan (main: 1.8019) - Acc: 0.5444
[INFO] Epoch 4 - Train Loss: nan (main: 2.2081) - Acc: 0.5716
[INFO] Epoch 4 - Val Loss: nan (main: 1.1954) - Acc: 0.6851
[INFO] Epoch 5 - Train Loss: nan (main: 1.9105) - Acc: 0.6607
[INFO] Epoch 5 - Val Loss: nan (main: 0.9976) - Acc: 0.7351
[INFO] Epoch 6 - Train Loss: nan (main: 1.6934) - Acc: 0.7306
[INFO] Epoch 6 - Val Loss: nan (main: 0.7796) - Acc: 0.7948
[INFO] Epoch 7 - Train Loss: nan (main: 1.5632) - Acc: 0.7716
[INFO] Epoch 7 - Val Loss: nan (main: 0.6334) - Acc: 0.8340
[INFO] Epoch 8 - Train Loss: nan (main: 1.4610) - Acc: 0.8041
[INFO] Epoch 8 - Val Loss: nan (main: 0.5956) - Acc: 0.8526
[INFO] Epoch 9 - Train Loss: nan (main: 1.3791) - Acc: 0.8305
[INFO] Epoch 9 - Val Loss: nan (main: 0.5344) - Acc: 0.8712
[INFO] Epoch 10 - Train Loss: nan (main: 1.3216) - Acc: 0.8488
[INFO] Epoch 10 - Val Loss: nan (main: 0.5299) - Acc: 0.8708
[INFO] Epoch 11 - Train Loss: nan (main: 1.2710) - Acc: 0.8652
[INFO] Epoch 11 - Val Loss: nan (main: 0.4588) - Acc: 0.8933
[INFO] Epoch 12 - Train Loss: nan (main: 1.2307) - Acc: 0.8785
[INFO] Epoch 12 - Val Loss: nan (main: 0.4896) - Acc: 0.8838
[INFO] Epoch 13 - Train Loss: nan (main: 1.2030) - Acc: 0.8861
[INFO] Epoch 13 - Val Loss: nan (main: 0.4337) - Acc: 0.9071
[INFO] Epoch 14 - Train Loss: nan (main: 1.1734) - Acc: 0.8950
[INFO] Epoch 14 - Val Loss: nan (main: 0.4526) - Acc: 0.9026
[INFO] Epoch 15 - Train Loss: nan (main: 1.1472) - Acc: 0.9042
[INFO] Epoch 15 - Val Loss: nan (main: 0.4020) - Acc: 0.9175
[INFO] Epoch 16 - Train Loss: nan (main: 1.1298) - Acc: 0.9092
[INFO] Epoch 16 - Val Loss: nan (main: 0.4243) - Acc: 0.9128
[INFO] Epoch 17 - Train Loss: nan (main: 1.1114) - Acc: 0.9141
[INFO] Epoch 17 - Val Loss: nan (main: 0.3977) - Acc: 0.9214
[INFO] Epoch 18 - Train Loss: nan (main: 1.0943) - Acc: 0.9201
[INFO] Epoch 18 - Val Loss: nan (main: 0.4151) - Acc: 0.9161
[INFO] Epoch 19 - Train Loss: nan (main: 1.0816) - Acc: 0.9234
[INFO] Epoch 19 - Val Loss: nan (main: 0.3814) - Acc: 0.9258
[INFO] Epoch 20 - Train Loss: nan (main: 1.0693) - Acc: 0.9270
[INFO] Epoch 20 - Val Loss: nan (main: 0.3939) - Acc: 0.9253
[INFO] Epoch 21 - Train Loss: nan (main: 1.0553) - Acc: 0.9313
[INFO] Epoch 21 - Val Loss: nan (main: 0.3817) - Acc: 0.9296
[INFO] Epoch 22 - Train Loss: nan (main: 1.0421) - Acc: 0.9351
[INFO] Epoch 22 - Val Loss: nan (main: 0.4093) - Acc: 0.9209
[INFO] Epoch 23 - Train Loss: nan (main: 1.0349) - Acc: 0.9380
[INFO] Epoch 23 - Val Loss: nan (main: 0.3960) - Acc: 0.9272
[INFO] Epoch 24 - Train Loss: nan (main: 1.0252) - Acc: 0.9403
[INFO] Epoch 24 - Val Loss: nan (main: 0.3811) - Acc: 0.9331
[INFO] Epoch 25 - Train Loss: nan (main: 1.0179) - Acc: 0.9428
[INFO] Epoch 25 - Val Loss: nan (main: 0.3855) - Acc: 0.9319
[INFO] Epoch 26 - Train Loss: nan (main: 1.0110) - Acc: 0.9441
[INFO] Epoch 26 - Val Loss: nan (main: 0.3910) - Acc: 0.9283
[INFO] Epoch 27 - Train Loss: nan (main: 1.0005) - Acc: 0.9477
[INFO] Epoch 27 - Val Loss: nan (main: 0.3822) - Acc: 0.9319
[INFO] Epoch 28 - Train Loss: nan (main: 0.9951) - Acc: 0.9483
[INFO] Epoch 28 - Val Loss: nan (main: 0.3634) - Acc: 0.9385
[INFO] Epoch 29 - Train Loss: nan (main: 0.9833) - Acc: 0.9524
[INFO] Epoch 29 - Val Loss: nan (main: 0.3436) - Acc: 0.9416
[INFO] Epoch 30 - Train Loss: nan (main: 0.9828) - Acc: 0.9527
[INFO] Epoch 30 - Val Loss: nan (main: 0.3625) - Acc: 0.9373
[INFO] Epoch 31 - Train Loss: nan (main: 0.9722) - Acc: 0.9559
[INFO] Epoch 31 - Val Loss: nan (main: 0.3543) - Acc: 0.9430
[INFO] Epoch 32 - Train Loss: nan (main: 0.9690) - Acc: 0.9565
[INFO] Epoch 32 - Val Loss: nan (main: 0.3455) - Acc: 0.9442
[INFO] Epoch 33 - Train Loss: nan (main: 0.9594) - Acc: 0.9589
[INFO] Epoch 33 - Val Loss: nan (main: 0.3586) - Acc: 0.9424
[INFO] Epoch 34 - Train Loss: nan (main: 0.9598) - Acc: 0.9592
[INFO] Epoch 34 - Val Loss: nan (main: 0.3421) - Acc: 0.9438
[INFO] Epoch 35 - Train Loss: nan (main: 0.9512) - Acc: 0.9620
[INFO] Epoch 35 - Val Loss: nan (main: 0.3796) - Acc: 0.9367
[INFO] Epoch 36 - Train Loss: nan (main: 0.9452) - Acc: 0.9633
[INFO] Epoch 36 - Val Loss: nan (main: 0.3289) - Acc: 0.9475
[INFO] Epoch 37 - Train Loss: nan (main: 0.9397) - Acc: 0.9647
[INFO] Epoch 37 - Val Loss: nan (main: 0.3748) - Acc: 0.9405
[INFO] Epoch 38 - Train Loss: nan (main: 0.9357) - Acc: 0.9657
[INFO] Epoch 38 - Val Loss: nan (main: 0.3447) - Acc: 0.9457
[INFO] Epoch 39 - Train Loss: nan (main: 0.9294) - Acc: 0.9676
[INFO] Epoch 39 - Val Loss: nan (main: 0.3549) - Acc: 0.9485
[INFO] Epoch 40 - Train Loss: nan (main: 0.9314) - Acc: 0.9666
[INFO] Epoch 40 - Val Loss: nan (main: 0.3518) - Acc: 0.9444
[INFO] Epoch 41 - Train Loss: nan (main: 0.9237) - Acc: 0.9691
[INFO] Epoch 41 - Val Loss: nan (main: 0.3652) - Acc: 0.9423
[INFO] Epoch 42 - Train Loss: nan (main: 0.9181) - Acc: 0.9706
[INFO] Epoch 42 - Val Loss: nan (main: 0.3462) - Acc: 0.9460
[INFO] Epoch 43 - Train Loss: nan (main: 0.9130) - Acc: 0.9716
[INFO] Epoch 43 - Val Loss: nan (main: 0.3418) - Acc: 0.9481
[INFO] Epoch 44 - Train Loss: nan (main: 0.9089) - Acc: 0.9722
[INFO] Epoch 44 - Val Loss: nan (main: 0.3401) - Acc: 0.9460
[INFO] Epoch 45 - Train Loss: nan (main: 0.9040) - Acc: 0.9744
[INFO] Epoch 45 - Val Loss: nan (main: 0.3129) - Acc: 0.9517
[INFO] Epoch 46 - Train Loss: nan (main: 0.9005) - Acc: 0.9755
[INFO] Epoch 46 - Val Loss: nan (main: 0.3309) - Acc: 0.9529
[INFO] Epoch 47 - Train Loss: nan (main: 0.8970) - Acc: 0.9759
[INFO] Epoch 47 - Val Loss: nan (main: 0.3283) - Acc: 0.9510
[INFO] Epoch 48 - Train Loss: nan (main: 0.8920) - Acc: 0.9777
[INFO] Epoch 48 - Val Loss: nan (main: 0.3313) - Acc: 0.9529
[INFO] Epoch 49 - Train Loss: nan (main: 0.8887) - Acc: 0.9787
[INFO] Epoch 49 - Val Loss: nan (main: 0.3198) - Acc: 0.9532
[INFO] Epoch 50 - Train Loss: nan (main: 0.8861) - Acc: 0.9788
[INFO] Epoch 50 - Val Loss: nan (main: 0.3352) - Acc: 0.9529
[INFO] Epoch 51 - Train Loss: nan (main: 0.8815) - Acc: 0.9804
[INFO] Epoch 51 - Val Loss: nan (main: 0.3225) - Acc: 0.9539
[INFO] Epoch 52 - Train Loss: nan (main: 0.8783) - Acc: 0.9812
[INFO] Epoch 52 - Val Loss: nan (main: 0.3332) - Acc: 0.9540
[INFO] Epoch 53 - Train Loss: nan (main: 0.8756) - Acc: 0.9817
[INFO] Epoch 53 - Val Loss: nan (main: 0.3398) - Acc: 0.9527
[INFO] Epoch 54 - Train Loss: nan (main: 0.8736) - Acc: 0.9824
[INFO] Epoch 54 - Val Loss: nan (main: 0.3416) - Acc: 0.9509
[INFO] Epoch 55 - Train Loss: nan (main: 0.8688) - Acc: 0.9836
[INFO] Epoch 55 - Val Loss: nan (main: 0.3269) - Acc: 0.9551
[INFO] Epoch 56 - Train Loss: nan (main: 0.8651) - Acc: 0.9845
[INFO] Epoch 56 - Val Loss: nan (main: 0.3373) - Acc: 0.9544
[INFO] Epoch 57 - Train Loss: nan (main: 0.8650) - Acc: 0.9844
[INFO] Epoch 57 - Val Loss: nan (main: 0.3158) - Acc: 0.9559
[INFO] Epoch 58 - Train Loss: nan (main: 0.8595) - Acc: 0.9854
[INFO] Epoch 58 - Val Loss: nan (main: 0.3233) - Acc: 0.9547
[INFO] Epoch 59 - Train Loss: nan (main: 0.8577) - Acc: 0.9864
[INFO] Epoch 59 - Val Loss: nan (main: 0.3266) - Acc: 0.9545
[INFO] Epoch 60 - Train Loss: nan (main: 0.8545) - Acc: 0.9870
[INFO] Epoch 60 - Val Loss: nan (main: 0.3200) - Acc: 0.9580
[INFO] Epoch 61 - Train Loss: nan (main: 0.8503) - Acc: 0.9883
[INFO] Epoch 61 - Val Loss: nan (main: 0.3079) - Acc: 0.9594
[INFO] Epoch 62 - Train Loss: nan (main: 0.8502) - Acc: 0.9877
[INFO] Epoch 62 - Val Loss: nan (main: 0.3165) - Acc: 0.9583
[INFO] Epoch 63 - Train Loss: nan (main: 0.8467) - Acc: 0.9891
[INFO] Epoch 63 - Val Loss: nan (main: 0.3274) - Acc: 0.9562
[INFO] Epoch 64 - Train Loss: nan (main: 0.8427) - Acc: 0.9901
[INFO] Epoch 64 - Val Loss: nan (main: 0.3345) - Acc: 0.9542
[INFO] Epoch 65 - Train Loss: nan (main: 0.8407) - Acc: 0.9906
[INFO] Epoch 65 - Val Loss: nan (main: 0.3406) - Acc: 0.9558
[INFO] Epoch 66 - Train Loss: nan (main: 0.8404) - Acc: 0.9906
[INFO] Epoch 66 - Val Loss: nan (main: 0.3073) - Acc: 0.9602
[INFO] Epoch 67 - Train Loss: nan (main: 0.8372) - Acc: 0.9914
[INFO] Epoch 67 - Val Loss: nan (main: 0.3093) - Acc: 0.9587
[INFO] Epoch 68 - Train Loss: nan (main: 0.8353) - Acc: 0.9916
[INFO] Epoch 68 - Val Loss: nan (main: 0.3132) - Acc: 0.9593
[INFO] Epoch 69 - Train Loss: nan (main: 0.8346) - Acc: 0.9919
[INFO] Epoch 69 - Val Loss: nan (main: 0.3038) - Acc: 0.9626
[INFO] Epoch 70 - Train Loss: nan (main: 0.8324) - Acc: 0.9923
[INFO] Epoch 70 - Val Loss: nan (main: 0.3056) - Acc: 0.9611
[INFO] Epoch 71 - Train Loss: nan (main: 0.8301) - Acc: 0.9933
[INFO] Epoch 71 - Val Loss: nan (main: 0.3090) - Acc: 0.9611
[INFO] Epoch 72 - Train Loss: nan (main: 0.8289) - Acc: 0.9933
[INFO] Epoch 72 - Val Loss: nan (main: 0.3162) - Acc: 0.9609
[INFO] Epoch 73 - Train Loss: nan (main: 0.8265) - Acc: 0.9940
[INFO] Epoch 73 - Val Loss: nan (main: 0.3138) - Acc: 0.9607
[INFO] Epoch 74 - Train Loss: nan (main: 0.8263) - Acc: 0.9941
[INFO] Epoch 74 - Val Loss: nan (main: 0.3146) - Acc: 0.9609
[INFO] Epoch 75 - Train Loss: nan (main: 0.8239) - Acc: 0.9944
[INFO] Epoch 75 - Val Loss: nan (main: 0.2967) - Acc: 0.9635
[INFO] Epoch 76 - Train Loss: nan (main: 0.8237) - Acc: 0.9945
[INFO] Epoch 76 - Val Loss: nan (main: 0.3000) - Acc: 0.9638
[INFO] Epoch 77 - Train Loss: nan (main: 0.8220) - Acc: 0.9948
[INFO] Epoch 77 - Val Loss: nan (main: 0.2988) - Acc: 0.9640
[INFO] Epoch 78 - Train Loss: nan (main: 0.8201) - Acc: 0.9953
[INFO] Epoch 78 - Val Loss: nan (main: 0.3044) - Acc: 0.9629
[INFO] Epoch 79 - Train Loss: nan (main: 0.8183) - Acc: 0.9958
[INFO] Epoch 79 - Val Loss: nan (main: 0.2997) - Acc: 0.9642
[INFO] Epoch 80 - Train Loss: nan (main: 0.8180) - Acc: 0.9958
[INFO] Epoch 80 - Val Loss: nan (main: 0.3038) - Acc: 0.9628
[INFO] Epoch 81 - Train Loss: nan (main: 0.8169) - Acc: 0.9960
[INFO] Epoch 81 - Val Loss: nan (main: 0.2974) - Acc: 0.9644
[INFO] Epoch 82 - Train Loss: nan (main: 0.8159) - Acc: 0.9964
[INFO] Epoch 82 - Val Loss: nan (main: 0.2913) - Acc: 0.9655
[INFO] Epoch 83 - Train Loss: nan (main: 0.8156) - Acc: 0.9963
[INFO] Epoch 83 - Val Loss: nan (main: 0.2953) - Acc: 0.9640
[INFO] Epoch 84 - Train Loss: nan (main: 0.8142) - Acc: 0.9967
[INFO] Epoch 84 - Val Loss: nan (main: 0.2860) - Acc: 0.9656
[INFO] Epoch 85 - Train Loss: nan (main: 0.8137) - Acc: 0.9967
[INFO] Epoch 85 - Val Loss: nan (main: 0.2933) - Acc: 0.9662
[INFO] Epoch 86 - Train Loss: nan (main: 0.8130) - Acc: 0.9970
[INFO] Epoch 86 - Val Loss: nan (main: 0.2936) - Acc: 0.9642
[INFO] Epoch 87 - Train Loss: nan (main: 0.8127) - Acc: 0.9970
[INFO] Epoch 87 - Val Loss: nan (main: 0.2905) - Acc: 0.9665
[INFO] Epoch 88 - Train Loss: nan (main: 0.8127) - Acc: 0.9970
[INFO] Epoch 88 - Val Loss: nan (main: 0.2936) - Acc: 0.9660
[INFO] Epoch 89 - Train Loss: nan (main: 0.8120) - Acc: 0.9972
[INFO] Epoch 89 - Val Loss: nan (main: 0.2947) - Acc: 0.9648
[INFO] Epoch 90 - Train Loss: nan (main: 0.8108) - Acc: 0.9974
[INFO] Epoch 90 - Val Loss: nan (main: 0.2895) - Acc: 0.9668
[INFO] Epoch 91 - Train Loss: nan (main: 0.8103) - Acc: 0.9976
[INFO] Epoch 91 - Val Loss: nan (main: 0.2947) - Acc: 0.9656
[INFO] Epoch 92 - Train Loss: nan (main: 0.8102) - Acc: 0.9975
[INFO] Epoch 92 - Val Loss: nan (main: 0.2920) - Acc: 0.9656
[INFO] Epoch 93 - Train Loss: nan (main: 0.8098) - Acc: 0.9976
[INFO] Epoch 93 - Val Loss: nan (main: 0.2938) - Acc: 0.9663
[INFO] Epoch 94 - Train Loss: nan (main: 0.8106) - Acc: 0.9974
[INFO] Epoch 94 - Val Loss: nan (main: 0.2927) - Acc: 0.9659
[INFO] Epoch 95 - Train Loss: nan (main: 0.8099) - Acc: 0.9976
[INFO] Epoch 95 - Val Loss: nan (main: 0.2940) - Acc: 0.9653
[INFO] Epoch 96 - Train Loss: nan (main: 0.8093) - Acc: 0.9979
[INFO] Epoch 96 - Val Loss: nan (main: 0.2925) - Acc: 0.9662
[INFO] Epoch 97 - Train Loss: nan (main: 0.8104) - Acc: 0.9975
[INFO] Epoch 97 - Val Loss: nan (main: 0.2931) - Acc: 0.9661
[INFO] Epoch 98 - Train Loss: nan (main: 0.8096) - Acc: 0.9976
[INFO] Epoch 98 - Val Loss: nan (main: 0.2920) - Acc: 0.9661
[INFO] Epoch 99 - Train Loss: nan (main: 0.8097) - Acc: 0.9977
[INFO] Epoch 99 - Val Loss: nan (main: 0.2925) - Acc: 0.9655
[INFO] Epoch 100 - Train Loss: nan (main: 0.8095) - Acc: 0.9978
[INFO] Epoch 100 - Val Loss: nan (main: 0.2931) - Acc: 0.9653
[INFO] Training completed!
[INFO] Best validation loss: inf

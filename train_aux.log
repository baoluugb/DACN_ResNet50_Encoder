[INFO] Device: cuda
[INFO] Dataset: CROHME
[INFO] Building vocabulary...
[INFO] Vocabulary size: 114
[INFO] Special tokens - PAD: 0, BOS: 1, EOS: 2
[INFO] Loading dataset...
[INFO] Max image size: 512
[INFO] Train samples: 7951, Val samples: 883
[INFO] Building model...
[INFO] Using CosineAnnealing scheduler with 2000 warmup steps
[INFO] Starting training from epoch 1 to 50...
[INFO] Early stopping: Disabled
[INFO] Epoch 1 - Train Loss: 4.0856 (main: 3.8286) - Acc: 0.1554
[INFO] Epoch 1 - Val Loss: nan (main: 3.3583) - Acc: 0.1870
[INFO] Epoch 2 - Train Loss: 3.7178 (main: 3.5320) - Acc: 0.2229
[INFO] Epoch 2 - Val Loss: nan (main: 2.7562) - Acc: 0.3201
[INFO] Epoch 3 - Train Loss: 3.1909 (main: 3.0429) - Acc: 0.3513
[INFO] Epoch 3 - Val Loss: nan (main: 2.4058) - Acc: 0.3940
[INFO] Epoch 4 - Train Loss: 2.9413 (main: 2.8172) - Acc: 0.4060
[INFO] Epoch 4 - Val Loss: nan (main: 2.2626) - Acc: 0.4313
[INFO] Epoch 5 - Train Loss: 2.7944 (main: 2.6836) - Acc: 0.4399
[INFO] Epoch 5 - Val Loss: nan (main: 2.0468) - Acc: 0.4767
[INFO] Epoch 6 - Train Loss: 2.6712 (main: 2.5686) - Acc: 0.4721
[INFO] Epoch 6 - Val Loss: nan (main: 1.9846) - Acc: 0.4826
[INFO] Epoch 7 - Train Loss: 2.5658 (main: 2.4693) - Acc: 0.4986
[INFO] Epoch 7 - Val Loss: nan (main: 1.8821) - Acc: 0.5098
[INFO] Epoch 8 - Train Loss: 2.4549 (main: 2.3645) - Acc: 0.5270
[INFO] Epoch 8 - Val Loss: nan (main: 1.6932) - Acc: 0.5491
[INFO] Epoch 9 - Train Loss: 2.3465 (main: 2.2611) - Acc: 0.5550
[INFO] Epoch 9 - Val Loss: nan (main: 1.5488) - Acc: 0.5857
[INFO] Epoch 10 - Train Loss: 2.2430 (main: 2.1623) - Acc: 0.5832
[INFO] Epoch 10 - Val Loss: nan (main: 1.3801) - Acc: 0.6290
[INFO] Epoch 11 - Train Loss: 2.1437 (main: 2.0672) - Acc: 0.6125
[INFO] Epoch 11 - Val Loss: nan (main: 1.2554) - Acc: 0.6612
[INFO] Epoch 12 - Train Loss: 2.0470 (main: 1.9751) - Acc: 0.6415
[INFO] Epoch 12 - Val Loss: nan (main: 1.2450) - Acc: 0.6595
[INFO] Epoch 13 - Train Loss: 1.9567 (main: 1.8886) - Acc: 0.6693
[INFO] Epoch 13 - Val Loss: nan (main: 1.0852) - Acc: 0.7061
[INFO] Epoch 14 - Train Loss: 1.8733 (main: 1.8089) - Acc: 0.6942
[INFO] Epoch 14 - Val Loss: nan (main: 0.9774) - Acc: 0.7364
[INFO] Epoch 15 - Train Loss: 1.7972 (main: 1.7360) - Acc: 0.7169
[INFO] Epoch 15 - Val Loss: nan (main: 0.8920) - Acc: 0.7593
[INFO] Epoch 16 - Train Loss: 1.7286 (main: 1.6709) - Acc: 0.7399
[INFO] Epoch 16 - Val Loss: nan (main: 0.9370) - Acc: 0.7459
[INFO] Epoch 17 - Train Loss: 1.6637 (main: 1.6091) - Acc: 0.7606
[INFO] Epoch 17 - Val Loss: nan (main: 0.7925) - Acc: 0.7881
[INFO] Epoch 18 - Train Loss: nan (main: 1.5566) - Acc: 0.7801
[INFO] Epoch 18 - Val Loss: nan (main: 0.7342) - Acc: 0.8057
[INFO] Epoch 19 - Train Loss: 1.5598 (main: 1.5105) - Acc: 0.7952
[INFO] Epoch 19 - Val Loss: nan (main: 0.7045) - Acc: 0.8164
[INFO] Epoch 20 - Train Loss: 1.5143 (main: 1.4675) - Acc: 0.8093
[INFO] Epoch 20 - Val Loss: nan (main: 0.6736) - Acc: 0.8230
[INFO] Epoch 21 - Train Loss: 1.4711 (main: 1.4271) - Acc: 0.8236
[INFO] Epoch 21 - Val Loss: nan (main: 0.6460) - Acc: 0.8287
[INFO] Epoch 22 - Train Loss: 1.4334 (main: 1.3914) - Acc: 0.8359
[INFO] Epoch 22 - Val Loss: nan (main: 0.6297) - Acc: 0.8335
[INFO] Epoch 23 - Train Loss: 1.3965 (main: 1.3563) - Acc: 0.8477
[INFO] Epoch 23 - Val Loss: nan (main: 0.6023) - Acc: 0.8459
[INFO] Epoch 24 - Train Loss: 1.3639 (main: 1.3256) - Acc: 0.8567
[INFO] Epoch 24 - Val Loss: nan (main: 0.5741) - Acc: 0.8518
[INFO] Epoch 25 - Train Loss: 1.3315 (main: 1.2952) - Acc: 0.8670
[INFO] Epoch 25 - Val Loss: nan (main: 0.5801) - Acc: 0.8537
[INFO] Epoch 26 - Train Loss: 1.3044 (main: 1.2699) - Acc: 0.8761
[INFO] Epoch 26 - Val Loss: nan (main: 0.5612) - Acc: 0.8566
[INFO] Epoch 27 - Train Loss: 1.2775 (main: 1.2442) - Acc: 0.8835
[INFO] Epoch 27 - Val Loss: nan (main: 0.5497) - Acc: 0.8597
[INFO] Epoch 28 - Train Loss: nan (main: 1.2210) - Acc: 0.8921
[INFO] Epoch 28 - Val Loss: nan (main: 0.5370) - Acc: 0.8661
[INFO] Epoch 29 - Train Loss: 1.2339 (main: 1.2031) - Acc: 0.8969
[INFO] Epoch 29 - Val Loss: nan (main: 0.5034) - Acc: 0.8747
[INFO] Epoch 30 - Train Loss: nan (main: 1.1833) - Acc: 0.9038
[INFO] Epoch 30 - Val Loss: nan (main: 0.4976) - Acc: 0.8781
[INFO] Epoch 31 - Train Loss: 1.1922 (main: 1.1643) - Acc: 0.9094
[INFO] Epoch 31 - Val Loss: nan (main: 0.5027) - Acc: 0.8754
[INFO] Epoch 32 - Train Loss: 1.1743 (main: 1.1474) - Acc: 0.9143
[INFO] Epoch 32 - Val Loss: nan (main: 0.4930) - Acc: 0.8811
[INFO] Epoch 33 - Train Loss: 1.1560 (main: 1.1301) - Acc: 0.9192
[INFO] Epoch 33 - Val Loss: nan (main: 0.4859) - Acc: 0.8828
[INFO] Epoch 34 - Train Loss: 1.1451 (main: 1.1202) - Acc: 0.9232
[INFO] Epoch 34 - Val Loss: nan (main: 0.4750) - Acc: 0.8867
[INFO] Epoch 35 - Train Loss: 1.1302 (main: 1.1059) - Acc: 0.9272
[INFO] Epoch 35 - Val Loss: nan (main: 0.4786) - Acc: 0.8850
[INFO] Epoch 36 - Train Loss: 1.1189 (main: 1.0955) - Acc: 0.9301
[INFO] Epoch 36 - Val Loss: nan (main: 0.4781) - Acc: 0.8864
[INFO] Epoch 37 - Train Loss: 1.1063 (main: 1.0837) - Acc: 0.9345
[INFO] Epoch 37 - Val Loss: nan (main: 0.4773) - Acc: 0.8891
[INFO] Epoch 38 - Train Loss: 1.0986 (main: 1.0764) - Acc: 0.9360
[INFO] Epoch 38 - Val Loss: nan (main: 0.4665) - Acc: 0.8892
[INFO] Epoch 39 - Train Loss: 1.0870 (main: 1.0656) - Acc: 0.9399
[INFO] Epoch 39 - Val Loss: nan (main: 0.4673) - Acc: 0.8897
[INFO] Epoch 40 - Train Loss: 1.0758 (main: 1.0550) - Acc: 0.9417
[INFO] Epoch 40 - Val Loss: nan (main: 0.4566) - Acc: 0.8922
[INFO] Epoch 41 - Train Loss: 1.0736 (main: 1.0529) - Acc: 0.9435
[INFO] Epoch 41 - Val Loss: nan (main: 0.4628) - Acc: 0.8909
[INFO] Epoch 42 - Train Loss: 1.0660 (main: 1.0461) - Acc: 0.9466
[INFO] Epoch 42 - Val Loss: nan (main: 0.4629) - Acc: 0.8939
[INFO] Epoch 43 - Train Loss: 1.0595 (main: 1.0399) - Acc: 0.9473
[INFO] Epoch 43 - Val Loss: nan (main: 0.4655) - Acc: 0.8925
[INFO] Epoch 44 - Train Loss: 1.0557 (main: 1.0362) - Acc: 0.9490
[INFO] Epoch 44 - Val Loss: nan (main: 0.4644) - Acc: 0.8935
[INFO] Epoch 45 - Train Loss: 1.0517 (main: 1.0326) - Acc: 0.9489
[INFO] Epoch 45 - Val Loss: nan (main: 0.4603) - Acc: 0.8935
[INFO] Epoch 46 - Train Loss: 1.0483 (main: 1.0294) - Acc: 0.9506
[INFO] Epoch 46 - Val Loss: nan (main: 0.4598) - Acc: 0.8946
[INFO] Epoch 47 - Train Loss: 1.0457 (main: 1.0268) - Acc: 0.9515
[INFO] Epoch 47 - Val Loss: nan (main: 0.4588) - Acc: 0.8942
[INFO] Epoch 48 - Train Loss: 1.0429 (main: 1.0245) - Acc: 0.9515
[INFO] Epoch 48 - Val Loss: nan (main: 0.4622) - Acc: 0.8943
[INFO] Epoch 49 - Train Loss: 1.0475 (main: 1.0284) - Acc: 0.9505
[INFO] Epoch 49 - Val Loss: nan (main: 0.4579) - Acc: 0.8939
[INFO] Epoch 50 - Train Loss: 1.0457 (main: 1.0270) - Acc: 0.9523
[INFO] Epoch 50 - Val Loss: nan (main: 0.4580) - Acc: 0.8933
[INFO] Training completed!
[INFO] Best validation loss: inf
[INFO] Device: cuda
[INFO] Dataset: CROHME
[INFO] Building vocabulary...
[INFO] Vocabulary size: 114
[INFO] Special tokens - PAD: 0, BOS: 1, EOS: 2
[INFO] Loading dataset...
[INFO] Max image size: 512
[INFO] Train samples: 7951, Val samples: 883
[INFO] Building model...
[INFO] Using CosineAnnealing scheduler with 2000 warmup steps
[INFO] Starting training from epoch 1 to 1...
[INFO] Early stopping: Disabled
[INFO] Epoch 1 - Train Loss: 3.8255 (main: 3.6024) - Acc: 0.2271
[INFO] Epoch 1 - Val Loss: nan (main: 3.3069) - Acc: 0.2820
[INFO] Training completed!
[INFO] Best validation loss: inf
